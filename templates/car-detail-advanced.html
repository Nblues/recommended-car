<!DOCTYPE html>
<html lang="th" itemscope itemtype="https://schema.org/WebPage">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{car_title} | ครูหนึ่งรถสวย - รถมือสองเชียงใหม่</title>
  <meta name="description" content="{car_description}">
  <link rel="canonical" href="{car_url}">
  
  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="product">
  <meta property="og:url" content="{car_url}">
  <meta property="og:title" content="{car_title} | ครูหนึ่งรถสวย">
  <meta property="og:description" content="{car_description}">
  <meta property="og:image" content="{car_main_image}">
  <meta property="og:site_name" content="ครูหนึ่งรถสวย">
  <meta property="og:locale" content="th_TH">
  <meta property="product:price:amount" content="{car_price}">
  <meta property="product:price:currency" content="THB">
  
  <!-- Twitter -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:url" content="{car_url}">
  <meta name="twitter:title" content="{car_title} | ครูหนึ่งรถสวย">
  <meta name="twitter:description" content="{car_description}">
  <meta name="twitter:image" content="{car_main_image}">
  
  <!-- SEO Meta -->
  <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1">
  <meta name="googlebot" content="index, follow">
  <meta name="bingbot" content="index, follow">
  <meta name="author" content="ครูหนึ่งรถสวย">
  
  <!-- Core Web Vitals Optimization -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preconnect" href="https://cdn.shopify.com" crossorigin>
  <link rel="dns-prefetch" href="//www.kn-goodcar.com">
  
  <!-- Preload Critical Resources -->
  <link rel="preload" href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;600;700;800&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;600;700;800&display=swap"></noscript>
  
  <!-- Resource Hints -->
  <link rel="preload" as="image" href="{car_main_image}">
  <link rel="preload" as="script" href="../image-optimization.js">
  <link rel="preload" as="style" href="../car-detail-style.css">
  
  <!-- Main CSS -->
  <link rel="stylesheet" href="../car-detail-style.css">
  
  <!-- Critical CSS Inline -->
  <style>
    /* Critical CSS สำหรับ LCP < 1.2s */
    :root {{
      --primary-color: #f47b20;
      --primary-dark: #e66a16;
      --success-color: #27ae60;
      --error-color: #e74c3c;
      --text-dark: #2c3e50;
      --text-light: #7f8c8d;
      --bg-light: #f7f7fb;
      --bg-white: #ffffff;
      --shadow-light: 0 4px 12px rgba(0,0,0,.08);
      --shadow-hover: 0 8px 24px rgba(0,0,0,.12);
      --border-radius: 12px;
      --border-radius-small: 8px;
      --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }}
    
    * {{ box-sizing: border-box; }}
    body {{ 
      font-family: 'Prompt', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      margin: 0;
      background: var(--bg-light);
      line-height: 1.6;
      color: var(--text-dark);
      font-size: 16px;
    }}
    
    .container {{ 
      max-width: 1200px;
      margin: 0 auto;
      padding: 1rem;
    }}
    
    /* Enhanced Car Header */
    .car-header {{ 
      background: var(--bg-white);
      border-radius: var(--border-radius);
      padding: 2.5rem;
      margin-bottom: 2rem;
      box-shadow: var(--shadow-light);
      position: relative;
      overflow: hidden;
    }}
    
    .car-header::before {{
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 5px;
      background: linear-gradient(90deg, var(--primary-color), var(--primary-dark));
    }}
    
    .car-title {{ 
      font-size: 2.2rem;
      font-weight: 700;
      margin: 0 0 1rem;
      color: var(--text-dark);
      line-height: 1.3;
    }}
    
    .car-price {{ 
      font-size: 2.8rem;
      color: var(--error-color);
      font-weight: 800;
      margin: 0 0 1.5rem;
      position: relative;
    }}
    
    .car-price::after {{
      content: 'บาท';
      font-size: 1.2rem;
      font-weight: 400;
      margin-left: 0.5rem;
      color: var(--text-light);
    }}
    
    .car-badges {{
      display: flex;
      flex-wrap: wrap;
      gap: 0.75rem;
      margin-top: 1.5rem;
    }}
    
    .car-badge {{ 
      display: inline-flex;
      align-items: center;
      background: linear-gradient(135deg, var(--success-color), #229954);
      color: white;
      padding: 0.6rem 1.2rem;
      border-radius: 25px;
      font-size: 0.9rem;
      font-weight: 500;
      box-shadow: 0 2px 8px rgba(39, 174, 96, 0.3);
      transition: var(--transition);
    }}
    
    .car-badge:hover {{
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(39, 174, 96, 0.4);
    }}
    
    /* Enhanced Gallery Layout */
    .car-gallery {{ 
      display: grid;
      grid-template-columns: 2.5fr 1fr;
      gap: 1.5rem;
      margin: 2rem 0;
    }}
    
    .main-image {{ 
      border-radius: var(--border-radius);
      overflow: hidden;
      background: #f0f0f0;
      position: relative;
      box-shadow: var(--shadow-light);
      transition: var(--transition);
    }}
    
    .main-image:hover {{
      box-shadow: var(--shadow-hover);
    }}
    
    .main-image img {{
      width: 100%;
      height: 450px;
      object-fit: cover;
      transition: var(--transition);
    }}
    
    .main-image:hover img {{
      transform: scale(1.02);
    }}
    
    .thumbnail-grid {{ 
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 0.75rem;
      height: fit-content;
    }}
    
    .thumbnail {{ 
      border-radius: var(--border-radius-small);
      overflow: hidden;
      background: #f0f0f0;
      cursor: pointer;
      transition: var(--transition);
      position: relative;
      aspect-ratio: 4/3;
    }}
    
    .thumbnail img {{
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: var(--transition);
    }}
    
    .thumbnail:hover {{
      transform: scale(1.05);
      box-shadow: var(--shadow-light);
    }}
    
    .thumbnail.active {{
      border: 3px solid var(--primary-color);
      box-shadow: 0 0 0 3px var(--primary-color);
    }}
    
    /* Enhanced Details Section */
    .car-details {{ 
      background: var(--bg-white);
      border-radius: var(--border-radius);
      padding: 2.5rem;
      margin-bottom: 2rem;
      box-shadow: var(--shadow-light);
    }}
    
    .car-details h2 {{
      color: var(--text-dark);
      font-size: 1.8rem;
      margin-bottom: 1.5rem;
      position: relative;
      padding-bottom: 0.5rem;
    }}
    
    .car-details h2::after {{
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      width: 60px;
      height: 3px;
      background: linear-gradient(90deg, var(--primary-color), var(--primary-dark));
      border-radius: 2px;
    }}
    
    .detail-grid {{ 
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 1.2rem;
      margin: 2rem 0;
    }}
    
    .detail-item {{ 
      padding: 1.5rem;
      background: linear-gradient(135deg, #f8f9fa, #ffffff);
      border-radius: var(--border-radius-small);
      border-left: 4px solid var(--primary-color);
      transition: var(--transition);
      position: relative;
    }}
    
    .detail-item:hover {{
      transform: translateY(-2px);
      box-shadow: var(--shadow-light);
    }}
    
    .detail-label {{ 
      font-weight: 600;
      color: var(--text-light);
      font-size: 0.9rem;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-bottom: 0.5rem;
    }}
    
    .detail-value {{ 
      font-size: 1.2rem;
      font-weight: 600;
      color: var(--text-dark);
    }}
    
    /* Enhanced CTA Section */
    .cta-section {{ 
      background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
      border-radius: var(--border-radius);
      padding: 3rem 2rem;
      text-align: center;
      color: white;
      margin: 2rem 0;
      position: relative;
      overflow: hidden;
    }}
    
    .cta-section::before {{
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
      animation: shimmer 3s infinite;
    }}
    
    @keyframes shimmer {{
      0% {{ transform: translateX(-100%); }}
      100% {{ transform: translateX(100%); }}
    }}
    
    .cta-section h2 {{
      font-size: 2rem;
      margin-bottom: 1rem;
      position: relative;
      z-index: 2;
    }}
    
    .cta-section p {{
      font-size: 1.1rem;
      margin-bottom: 2rem;
      opacity: 0.9;
      position: relative;
      z-index: 2;
    }}
    
    .cta-button {{ 
      display: inline-block;
      background: var(--bg-white);
      color: var(--primary-color);
      padding: 1.2rem 2.5rem;
      border-radius: var(--border-radius-small);
      text-decoration: none;
      font-weight: 700;
      font-size: 1.1rem;
      margin: 0.5rem 0.75rem;
      transition: var(--transition);
      position: relative;
      z-index: 2;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }}
    
    .cta-button:hover {{ 
      transform: translateY(-3px);
      box-shadow: 0 8px 24px rgba(0,0,0,0.15);
      background: #f8f9fa;
    }}
    
    /* Button Layout */
    .cta-buttons-row {{
      display: flex;
      justify-content: center;
      align-items: center;
      flex-wrap: wrap;
      gap: 1rem;
      margin-bottom: 1.5rem;
    }}
    
    /* Button Specific Styles */
    .home-btn {{
      background: linear-gradient(135deg, #3498db, #2980b9);
      color: white;
    }}
    
    .home-btn:hover {{
      background: linear-gradient(135deg, #2980b9, #21618c);
      color: white;
    }}
    
    .view-all-btn {{
      background: linear-gradient(135deg, #9b59b6, #8e44ad);
      color: white;
    }}
    
    .view-all-btn:hover {{
      background: linear-gradient(135deg, #8e44ad, #7d3c98);
      color: white;
    }}
    
    .facebook-btn {{
      background: linear-gradient(135deg, #3b5998, #2d4373);
      color: white;
    }}
    
    .facebook-btn:hover {{
      background: linear-gradient(135deg, #2d4373, #1e2e4f);
      color: white;
    }}
    
    .line-btn {{
      background: linear-gradient(135deg, #00b900, #00a000);
      color: white;
    }}
    
    .line-btn:hover {{
      background: linear-gradient(135deg, #00a000, #008000);
      color: white;
    }}
    
    .phone-btn {{
      background: linear-gradient(135deg, #e74c3c, #c0392b);
      color: white;
    }}
    
    .phone-btn:hover {{
      background: linear-gradient(135deg, #c0392b, #a93226);
      color: white;
    }}
    
    /* Mobile Responsive */
    @media (max-width: 768px) {{
      .cta-buttons-row {{
        flex-direction: column;
        gap: 0.75rem;
      }}
      
      .cta-button {{
        width: 100%;
        max-width: 280px;
        text-align: center;
        margin: 0;
        padding: 1rem 1.5rem;
        font-size: 1rem;
      }}
    }}
    
    @media (max-width: 480px) {{
      .cta-button {{
        padding: 0.9rem 1.2rem;
        font-size: 0.95rem;
      }}
    }}
    
    /* Enhanced Breadcrumb */
    .breadcrumb {{ 
      margin: 1.5rem 0;
      font-size: 0.95rem;
      padding: 1rem;
      background: var(--bg-white);
      border-radius: var(--border-radius-small);
      box-shadow: var(--shadow-light);
    }}
    
    .breadcrumb a {{ 
      color: var(--primary-color);
      text-decoration: none;
      font-weight: 500;
      transition: var(--transition);
    }}
    
    .breadcrumb a:hover {{ 
      text-decoration: underline;
      color: var(--primary-dark);
    }}
    
    /* Car Description */
    .car-description {{
      font-size: 1.1rem;
      line-height: 1.8;
      color: var(--text-dark);
      margin-top: 1.5rem;
      padding: 1.5rem;
      background: linear-gradient(135deg, #f8f9fa, #ffffff);
      border-radius: var(--border-radius-small);
      border-left: 4px solid var(--primary-color);
    }}
    
    /* Related Cars Section */
    .related-cars {{
      margin-top: 3rem;
      padding: 2rem;
      background: var(--bg-white);
      border-radius: var(--border-radius);
      box-shadow: var(--shadow-light);
    }}
    
    .related-cars h2 {{
      text-align: center;
      margin-bottom: 2rem;
      color: var(--text-dark);
      font-size: 1.8rem;
    }}
    
    /* Responsive Design */
    @media (max-width: 768px) {{
      .car-gallery {{ 
        grid-template-columns: 1fr;
        gap: 1rem;
      }}
      
      .thumbnail-grid {{
        grid-template-columns: repeat(4, 1fr);
      }}
      
      .car-title {{ 
        font-size: 1.6rem;
      }}
      
      .car-price {{ 
        font-size: 2.2rem;
      }}
      
      .car-header {{
        padding: 1.5rem;
      }}
      
      .detail-grid {{
        grid-template-columns: 1fr;
      }}
      
      .cta-section {{
        padding: 2rem 1rem;
      }}
      
      .cta-button {{
        display: block;
        margin: 0.5rem 0;
      }}
      
      .car-badges {{
        justify-content: center;
      }}
    }}
    
    @media (max-width: 480px) {{
      .container {{
        padding: 0.5rem;
      }}
      
      .car-title {{
        font-size: 1.4rem;
      }}
      
      .car-price {{
        font-size: 1.8rem;
      }}
      
      .main-image img {{
        height: 250px;
      }}
    }}
  </style>
  
  <!-- Structured Data -->
  <script type="application/ld+json" id="product-schema">
  {product_schema}
  </script>
  
  <script type="application/ld+json" id="breadcrumb-schema">
  {breadcrumb_schema}
  </script>
  
  <script type="application/ld+json" id="local-business-schema">
  {local_business_schema}
  </script>
  
  <!-- PWA Manifest -->
  <link rel="manifest" href="../manifest.json">
  <link rel="icon" type="image/x-icon" href="../favicon.ico">
  <link rel="apple-touch-icon" href="../apple-touch-icon.png">
</head>

<body>
  <!-- Breadcrumb Navigation -->
  <div class="container">
    <nav class="breadcrumb" aria-label="breadcrumb">
      <a href="/">หน้าแรก</a> › 
      <a href="/car-detail/">รถทั้งหมด</a> › 
      <span>{car_title}</span>
    </nav>
  </div>

  <!-- Car Header -->
  <div class="container">
    <header class="car-header">
      <h1 class="car-title">{car_title}</h1>
      <div class="car-price">฿{car_price:,.0f}</div>
      <div class="car-badges">
        <span class="car-badge">🚗 {car_brand}</span>
        <span class="car-badge">📍 เชียงใหม่</span>
        <span class="car-badge">✅ รับประกัน 1 ปี</span>
        <span class="car-badge">🚚 ส่งฟรีทั่วไทย</span>
      </div>
    </header>
  </div>

  <!-- Car Gallery -->
  <div class="container">
    <section class="car-gallery" aria-label="รูปภาพรถยนต์">
      <div class="main-image">
        {hero_image_html}
      </div>
      <div class="thumbnail-grid">
        {thumbnail_images_html}
      </div>
    </section>
  </div>

  <!-- Car Details -->
  <div class="container">
    <section class="car-details">
      <h2>รายละเอียดรถยนต์</h2>
      <div class="detail-grid">
        <div class="detail-item">
          <div class="detail-label">ราคา</div>
          <div class="detail-value">฿{car_price:,.0f}</div>
        </div>
        <div class="detail-item">
          <div class="detail-label">ยี่ห้อ</div>
          <div class="detail-value">{car_brand}</div>
        </div>
        <div class="detail-item">
          <div class="detail-label">สถานะ</div>
          <div class="detail-value">พร้อมขาย</div>
        </div>
        <div class="detail-item">
          <div class="detail-label">การรับประกัน</div>
          <div class="detail-value">1 ปี</div>
        </div>
        <div class="detail-item">
          <div class="detail-label">การจัดส่ง</div>
          <div class="detail-value">ฟรีทั่วไทย</div>
        </div>
        <div class="detail-item">
          <div class="detail-label">ไฟแนนซ์</div>
          <div class="detail-value">ฟรีดาวน์</div>
        </div>
      </div>
      
      <h3>คำอธิบาย</h3>
      <div class="car-description">
        {car_full_description}
      </div>
    </section>
  </div>

  <!-- CTA Section -->
  <div class="container">
    <section class="cta-section">
      <h2>สนใจรถคันนี้?</h2>
      <p>ติดต่อเราเพื่อดูรถ ทดลองขับ และจัดไฟแนนซ์</p>
      
      <!-- Navigation Buttons Row 1 -->
      <div class="cta-buttons-row">
        <a href="../index.html" class="cta-button home-btn">
          🏠 กลับหน้าหลัก
        </a>
        <a href="https://chiangraiusedcar.com/all-cars-1" class="cta-button view-all-btn" target="_blank" rel="noopener">
          � ดูรถทั้งหมด
        </a>
      </div>
      
      <!-- Contact Buttons Row 2 -->
      <div class="cta-buttons-row">
        <a href="https://www.facebook.com/KN2car" class="cta-button facebook-btn" target="_blank" rel="noopener">
          📘 Facebook
        </a>
        <a href="https://line.me/ti/p/~0940649019" class="cta-button line-btn" target="_blank" rel="noopener">
          � Line
        </a>
        <a href="tel:0940649019" class="cta-button phone-btn">
          � โทรเลย
        </a>
      </div>
    </section>
  </div>

  <!-- Related Cars -->
  <div class="container">
    <section class="related-cars">
      <h2>รถแนะนำอื่นๆ</h2>
      <div id="related-cars-grid">
        <!-- จะถูกโหลดด้วย JavaScript -->
      </div>
    </section>
  </div>

  <!-- Performance Optimization Scripts -->
  <script>
    // Service Worker Registration
    if ('serviceWorker' in navigator) {{
      window.addEventListener('load', () => {{
        navigator.serviceWorker.register('../sw.js')
          .then(reg => console.log('SW registered'))
          .catch(err => console.log('SW registration failed'));
      }});
    }}

    // Enhanced Image Gallery Functionality
    document.addEventListener('DOMContentLoaded', function() {{
      const thumbnails = document.querySelectorAll('.thumbnail img');
      const mainImage = document.querySelector('.main-image img');
      const thumbnailContainers = document.querySelectorAll('.thumbnail');
      
      thumbnails.forEach((thumb, index) => {{
        const container = thumbnailContainers[index];
        
        thumb.addEventListener('click', () => {{
          // Update main image
          const newSrc = thumb.src.replace('_300x225', '_900x675');
          if (mainImage) {{
            mainImage.src = newSrc;
            mainImage.alt = thumb.alt;
            
            // Add loading animation
            mainImage.style.opacity = '0.7';
            setTimeout(() => {{
              mainImage.style.opacity = '1';
            }}, 200);
          }}
          
          // Update active thumbnail
          thumbnailContainers.forEach(tc => tc.classList.remove('active'));
          container.classList.add('active');
        }});
        
        // Set first thumbnail as active
        if (index === 0) {{
          container.classList.add('active');
        }}
      }});

      // Lazy load related cars with enhanced animation
      setTimeout(loadRelatedCars, 2000);
      
      // Add scroll animations
      const observerOptions = {{
        threshold: 0.1,
        rootMargin: '0px 0px -50px 0px'
      }};
      
      const observer = new IntersectionObserver((entries) => {{
        entries.forEach(entry => {{
          if (entry.isIntersecting) {{
            entry.target.style.opacity = '1';
            entry.target.style.transform = 'translateY(0)';
          }}
        }});
      }}, observerOptions);
      
      // Observe elements for animation
      document.querySelectorAll('.car-details, .cta-section, .related-cars').forEach(el => {{
        el.style.opacity = '0';
        el.style.transform = 'translateY(30px)';
        el.style.transition = 'all 0.6s cubic-bezier(0.4, 0, 0.2, 1)';
        observer.observe(el);
      }});
    }});

    function loadRelatedCars() {{
      const relatedGrid = document.getElementById('related-cars-grid');
      if (!relatedGrid) return;
      
      // Enhanced loading animation
      relatedGrid.innerHTML = `
        <div style="text-align: center; padding: 2rem;">
          <div style="display: inline-block; width: 40px; height: 40px; border: 4px solid #f3f3f3; border-top: 4px solid var(--primary-color); border-radius: 50%; animation: spin 1s linear infinite;"></div>
          <p style="margin-top: 1rem; color: var(--text-light);">กำลังโหลดรถแนะนำ...</p>
        </div>
        <style>
          @keyframes spin {{
            0% {{ transform: rotate(0deg); }}
            100% {{ transform: rotate(360deg); }}
          }}
        </style>
      `;
      
      // Simulate loading related cars
      setTimeout(() => {{
        relatedGrid.innerHTML = `
          <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 1.5rem;">
            <div style="background: white; border-radius: 12px; padding: 1rem; box-shadow: 0 4px 12px rgba(0,0,0,0.08); transition: transform 0.3s;" onmouseover="this.style.transform='translateY(-5px)'" onmouseout="this.style.transform='translateY(0)'">
              <div style="height: 180px; background: linear-gradient(45deg, #f0f0f0, #e0e0e0); border-radius: 8px; margin-bottom: 1rem;"></div>
              <h4 style="margin: 0 0 0.5rem; color: var(--text-dark);">รถแนะนำ #1</h4>
              <p style="color: var(--primary-color); font-weight: bold; font-size: 1.2rem;">฿450,000</p>
            </div>
            <div style="background: white; border-radius: 12px; padding: 1rem; box-shadow: 0 4px 12px rgba(0,0,0,0.08); transition: transform 0.3s;" onmouseover="this.style.transform='translateY(-5px)'" onmouseout="this.style.transform='translateY(0)'">
              <div style="height: 180px; background: linear-gradient(45deg, #f0f0f0, #e0e0e0); border-radius: 8px; margin-bottom: 1rem;"></div>
              <h4 style="margin: 0 0 0.5rem; color: var(--text-dark);">รถแนะนำ #2</h4>
              <p style="color: var(--primary-color); font-weight: bold; font-size: 1.2rem;">฿320,000</p>
            </div>
            <div style="background: white; border-radius: 12px; padding: 1rem; box-shadow: 0 4px 12px rgba(0,0,0,0.08); transition: transform 0.3s;" onmouseover="this.style.transform='translateY(-5px)'" onmouseout="this.style.transform='translateY(0)'">
              <div style="height: 180px; background: linear-gradient(45deg, #f0f0f0, #e0e0e0); border-radius: 8px; margin-bottom: 1rem;"></div>
              <h4 style="margin: 0 0 0.5rem; color: var(--text-dark);">รถแนะนำ #3</h4>
              <p style="color: var(--primary-color); font-weight: bold; font-size: 1.2rem;">฿580,000</p>
            </div>
          </div>
        `;
      }}, 1500);
    }}

    // Enhanced Performance monitoring with Web Vitals
    if ('PerformanceObserver' in window) {{
      const perfObserver = new PerformanceObserver((list) => {{
        for (const entry of list.getEntries()) {{
          if (entry.entryType === 'largest-contentful-paint') {{
            console.log('🎯 LCP:', entry.startTime.toFixed(2) + 'ms');
            
            // Visual feedback for good performance
            if (entry.startTime < 1200) {{
              document.body.style.setProperty('--performance-color', '#27ae60');
            }} else if (entry.startTime < 2500) {{
              document.body.style.setProperty('--performance-color', '#f39c12');
            }} else {{
              document.body.style.setProperty('--performance-color', '#e74c3c');
            }}
          }}
          
          if (entry.entryType === 'first-input-delay') {{
            console.log('🖱️ FID:', entry.processingStart - entry.startTime + 'ms');
          }}
        }}
      }});
      
      try {{
        perfObserver.observe({{entryTypes: ['largest-contentful-paint', 'first-input']}});
      }} catch (e) {{
        // Fallback for older browsers
        console.log('Performance Observer not fully supported');
      }}
    }}
    
    // Add smooth scroll behavior
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {{
      anchor.addEventListener('click', function (e) {{
        e.preventDefault();
        const target = document.querySelector(this.getAttribute('href'));
        if (target) {{
          target.scrollIntoView({{
            behavior: 'smooth',
            block: 'start'
          }});
        }}
      }});
    }});
  </script>

  <!-- Non-critical CSS -->
  <link rel="stylesheet" href="../image-optimization.css" media="print" onload="this.media='all'">
  <noscript><link rel="stylesheet" href="../image-optimization.css"></noscript>
  
  <!-- Enhanced Car Detail CSS -->
  <link rel="stylesheet" href="../car-detail-enhanced.css" media="print" onload="this.media='all'">
  <noscript><link rel="stylesheet" href="../car-detail-enhanced.css"></noscript>
  
  <!-- Async Scripts for Performance -->
  <script async src="../image-optimization.js"></script>
  
  <!-- JSON-LD for FAQ -->
  <script type="application/ld+json">
  {faq_schema}
  </script>

</body>
</html>