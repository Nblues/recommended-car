<!DOCTYPE html>
<html lang="th" itemscope itemtype="https://schema.org/WebPage">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link type="text/plain" rel="author" href="humans.txt">

<!-- Comprehensive Favicon System 2025 -->
    <link rel="icon" type="image/x-icon" href="docs/favicon.ico">
    <link rel="icon" type="image/png" sizes="32x32" href="docs/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="docs/favicon-16x16.png">
    <link rel="apple-touch-icon" sizes="180x180" href="docs/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="192x192" href="docs/android-chrome-192x192.png">
    <link rel="icon" type="image/png" sizes="512x512" href="docs/android-chrome-512x512.png">
    <link rel="manifest" href="docs/manifest.json">
    <meta name="msapplication-TileColor" content="#f47b20">
    <meta name="msapplication-config" content="docs/browserconfig.xml">
    
    <!-- Enhanced SEO Meta Tags -->
    <title>รถมือสองเชียงใหม่ เข้าใหม่ 6 คันล่าสุด ฟรีดาวน์ | ครูหนึ่งรถสวย</title>
    <meta name="description" content="รถบ้านเข้าใหม่ 6 คันล่าสุด รถมือสองเชียงใหม่ ฟรีดาวน์ ผ่อนถูก รถบ้านสวย ตรวจสอบได้จริงทุกคัน พร้อมรายละเอียด รูปภาพ สเปคครบ SEO เต็ม">
    <meta name="keywords" content="รถมือสอง, รถมือสองเชียงใหม่, ครูหนึ่งรถสวย, รถยนต์มือสอง, ขายรถมือสอง, ฟรีดาวน์, ส่งฟรีทั่วไทย, Toyota, Honda, Nissan, Ford, Mazda, Hyundai, Isuzu, Mitsubishi, BMW, Mercedes-Benz, รถเก๋ง, รถกระบะ, รถ SUV, รถ MPV, รถ Hybrid, รถดีเซล, รถเบนซิน, เกียร์ออโต้, เกียร์ธรรมดา, ฟรีดาวน์, ผ่อนง่าย, รับประกัน, ตรวจสภาพ, ส่งฟรี, จัดไฟแนนซ์, แลกเปลี่ยน">
    <link rel="canonical" href="https://nblues.github.io/recommended-car/">
    <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1">
    <meta name="googlebot" content="index, follow">
    <meta name="bingbot" content="index, follow">
    <meta name="author" content="ครูหนึ่งรถสวย">
    <meta name="geo.region" content="TH-50">
    <meta name="geo.placename" content="เชียงใหม่">
    <meta name="geo.position" content="18.7883;98.9853">
    <meta name="ICBM" content="18.7883, 98.9853">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://nblues.github.io/recommended-car/">
    <meta property="og:title" content="รถมือสองเชียงใหม่ เข้าใหม่ 6 คันล่าสุด ฟรีดาวน์ | ครูหนึ่งรถสวย">
    <meta property="og:description" content="รถบ้านเข้าใหม่ 6 คันล่าสุด รถมือสองเชียงใหม่ ฟรีดาวน์ ผ่อนถูก รถบ้านสวย สเปคครบ เช็คเครดิตได้ทันที SEO เต็ม">
    <meta property="og:image" content="https://cdn.shopify.com/s/files/1/0718/1441/4580/files/rn-image_picker_lib_temp_ee2a3ecd-09bf-433d-94c8-09063d62288b.jpg?v=1725842830">
    <meta property="og:site_name" content="ครูหนึ่งรถสวย รถมือสองเชียงใหม่">
    <meta property="og:locale" content="th_TH">

    <!-- Twitter Cards -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:url" content="https://nblues.github.io/recommended-car/">
    <meta name="twitter:title" content="รถมือสองเชียงใหม่ 6 คันล่าสุด ฟรีดาวน์ | ครูหนึ่งรถสวย">
    <meta name="twitter:description" content="รวมรถเข้าใหม่ 6 คัน รถบ้านเชียงใหม่ ฟรีดาวน์ ผ่อนถูก เช็คเครดิตไว รถสวยเกรด A ทุกคัน">
    <meta name="twitter:image" content="https://cdn.shopify.com/s/files/1/0718/1441/4580/files/rn-image_picker_lib_temp_ee2a3ecd-09bf-433d-94c8-09063d62288b.jpg?v=1725842830">

    <!-- Performance Optimization -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://cdn.shopify.com" crossorigin>
    <link rel="dns-prefetch" href="//chiangraiusedcar.com">
    <link rel="dns-prefetch" href="//www.kn-goodcar.com">
    
    <!-- Preload Critical Resources -->
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;600;700;800&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;600;700;800&display=swap"></noscript>

    <!-- Breadcrumb Schema -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "BreadcrumbList",
        "itemListElement": [
            {
                "@type": "ListItem",
                "position": 1,
                "name": "หน้าแรก",
                "item": "https://nblues.github.io/recommended-car/"
            },
            {
                "@type": "ListItem",
                "position": 2,
                "name": "รถมือสองเชียงใหม่",
                "item": "https://nblues.github.io/recommended-car/"
            }
        ]
    }
    </script>

    <!-- ItemList Schema for Cars -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "ItemList",
        "name": "รถมือสองเชียงใหม่ ฟรีดาวน์",
        "description": "รถบ้านเข้าใหม่ 6 คันล่าสุด รถมือสองเชียงใหม่ คุณภาพดี ฟรีดาวน์ ผ่อนถูก",
        "numberOfItems": 6,
        "itemListElement": []
    }
    </script>

    <!-- LocalBusiness Schema -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "LocalBusiness",
        "name": "ครูหนึ่งรถสวย",
        "image": "https://cdn.shopify.com/s/files/1/0718/1441/4580/files/logo.jpg",
        "telephone": "0940649019",
        "url": "https://nblues.github.io/recommended-car/",
        "address": {
            "@type": "PostalAddress",
            "streetAddress": "320 หมู่ 2 ต.สันพระเนตร",
            "addressLocality": "สันทราย",
            "addressRegion": "เชียงใหม่",
            "postalCode": "50210",
            "addressCountry": "TH"
        },
        "geo": {
            "@type": "GeoCoordinates",
            "latitude": 18.7883,
            "longitude": 98.9853
        },
        "sameAs": [
            "https://www.facebook.com/KN2car",
            "https://www.facebook.com/nuengblues",
            "https://www.tiktok.com/@krunueng_usedcar",
            "https://youtube.com/@chiangraiusedcar"
        ],
        "priceRange": "฿289,000 - ฿1,169,000",
        "openingHours": "Mo-Su 08:00-20:00",
        "description": "รถมือสองเชียงใหม่ ฟรีดาวน์ ผ่อนถูก รับประกัน ส่งฟรีทั่วไทย"
    }
    </script>

    <!-- Organization Schema -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "Organization",
        "name": "ครูหนึ่งรถสวย",
        "url": "https://nblues.github.io/recommended-car/",
        "logo": "https://cdn.shopify.com/s/files/1/0718/1441/4580/files/logo.jpg",
        "contactPoint": {
            "@type": "ContactPoint",
            "telephone": "+66940649019",
            "contactType": "sales",
            "areaServed": "TH",
            "availableLanguage": "Thai"
        },
        "address": {
            "@type": "PostalAddress",
            "streetAddress": "320 หมู่ 2 ต.สันพระเนตร",
            "addressLocality": "สันทราย",
            "addressRegion": "เชียงใหม่",
            "postalCode": "50210",
            "addressCountry": "TH"
        }
    }
    </script>

    <!-- WebSite Schema -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebSite",
        "name": "ครูหนึ่งรถสวย รถมือสองเชียงใหม่",
        "url": "https://nblues.github.io/recommended-car/",
        "description": "รถมือสองเชียงใหม่ ฟรีดาวน์ ผ่อนถูก รับประกัน ส่งฟรีทั่วไทย",
        "publisher": {
            "@type": "Organization",
            "name": "ครูหนึ่งรถสวย",
            "logo": {
                "@type": "ImageObject",
                "url": "https://cdn.shopify.com/s/files/1/0718/1441/4580/files/logo.jpg"
            }
        },
        "potentialAction": {
            "@type": "SearchAction",
            "target": "https://nblues.github.io/recommended-car/?search={search_term_string}",
            "query-input": "required name=search_term_string"
        }
    }
    </script>

    <!-- FAQ Schema -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "FAQPage",
        "mainEntity": [
            {
                "@type": "Question",
                "name": "รถมือสองเชียงใหม่ที่ไหนดี?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "ครูหนึ่งรถสวย เชียงใหม่ คัดเฉพาะรถคุณภาพ รับประกัน 1 ปี ฟรีดาวน์ ส่งฟรีทั่วไทย มีรถเข้าใหม่ทุกวัน ตรวจสภาพละเอียด"
                }
            },
            {
                "@type": "Question",
                "name": "ผ่อนรถมือสองขั้นต่ำเท่าไหร่?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "เริ่มต้น 3,000 บาท/เดือน ฟรีดาวน์ อนุมัติง่าย ไม่ติดเครดิตบูโร มีรถให้เลือกหลากหลายราคา"
                }
            },
            {
                "@type": "Question",
                "name": "มีรับประกันรถมือสองไหม?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "รับประกัน 1 ปีเต็ม เครื่องยนต์ เกียร์ ช่วงล่าง พร้อมบริการหลังการขาย ศูนย์บริการทั่วประเทศ"
                }
            },
            {
                "@type": "Question",
                "name": "ส่งรถฟรีจริงหรือ?",
                "acceptedAnswer": {
                    "@type": "Answer",
                    "text": "ส่งฟรีทั่วประเทศจริง รถถึงบ้านคุณ พร้อมเอกสารครบถ้วน ตรวจสภาพก่อนรับมอบ"
                }
            }
        ]
    }
    </script>

    <style>
        /* Reset และ Base Styles */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Prompt', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: #fffaf6;
            color: #2c3e50;
            line-height: 1.6;
            font-size: 16px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 1rem;
        }

        /* Header Section */
        .header {
            background: linear-gradient(135deg, #f47b20, #e66a16);
            color: white;
            text-align: center;
            padding: 2rem 1rem;
            margin-bottom: 2rem;
            border-radius: 16px;
            box-shadow: 0 8px 32px rgba(244, 123, 32, 0.2);
        }

        .header h1 {
            font-size: 2.5rem;
            font-weight: 800;
            margin-bottom: 0.5rem;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.2rem;
            margin-bottom: 1.5rem;
            opacity: 0.95;
        }

        .header-features {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .header-feature {
            background: rgba(255,255,255,0.2);
            padding: 0.5rem 1rem;
            border-radius: 25px;
            font-weight: 600;
            font-size: 0.9rem;
            backdrop-filter: blur(10px);
        }

        /* Cars Grid Layout */
        .cars-section {
            margin-bottom: 2rem;
        }

        .section-title {
            text-align: center;
            font-size: 2rem;
            color: #2c3e50;
            margin-bottom: 2rem;
            font-weight: 700;
        }

        .cars-grid {
            display: grid;
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        /* Desktop: 3 คัน 2 แถว */
        @media (min-width: 769px) {
            .cars-grid {
                grid-template-columns: repeat(3, 1fr);
                max-width: 1200px;
                margin: 0 auto 2rem auto;
            }
        }

        /* Mobile: 2 คัน 3 แถว */
        @media (max-width: 768px) {
            .cars-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 1rem;
            }
            
            .header h1 {
                font-size: 1.8rem;
            }
            
            .header p {
                font-size: 1rem;
            }
            
            .header-features {
                gap: 0.5rem;
            }
            
            .header-feature {
                font-size: 0.8rem;
                padding: 0.4rem 0.8rem;
            }
        }

        /* Car Card Styles */
        .car-card {
            background: white;
            border-radius: 16px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.08);
            overflow: hidden;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border: 1px solid #f0f0f0;
            display: flex;
            flex-direction: column;
            height: 100%;
        }

        .car-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 12px 40px rgba(0,0,0,0.15);
            border-color: #f47b20;
        }

        .car-image-container {
            position: relative;
            width: 100%;
            height: 200px;
            overflow: hidden;
        }

        .car-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            object-position: center;
            transition: transform 0.3s ease;
        }

        .car-card:hover .car-image {
            transform: scale(1.05);
        }

        .car-content {
            padding: 1.25rem;
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .car-title {
            font-size: 1.1rem;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 0.75rem;
            line-height: 1.4;
            height: 2.8em;
            overflow: hidden;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
        }

        .car-price {
            font-size: 1.4rem;
            color: #27ae60;
            font-weight: 800;
            margin-bottom: 0.75rem;
        }

        .car-details {
            flex: 1;
            margin-bottom: 1rem;
        }

        .car-status {
            background: #e8f5e8;
            color: #27ae60;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            display: inline-block;
            margin-bottom: 0.75rem;
        }

        .car-features {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .car-feature {
            background: #f8f9fa;
            color: #6c757d;
            padding: 0.25rem 0.5rem;
            border-radius: 8px;
            font-size: 0.8rem;
            font-weight: 500;
        }

        .car-description {
            font-size: 0.9rem;
            color: #6c757d;
            line-height: 1.5;
            height: 3em;
            overflow: hidden;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            margin-bottom: 1rem;
        }

        /* Button Styles */
        .btn-detail {
            background: linear-gradient(135deg, #f47b20, #e66a16);
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 12px;
            font-weight: 700;
            font-size: 0.95rem;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            text-align: center;
            display: block;
            margin-top: auto;
        }

        .btn-detail:hover {
            background: linear-gradient(135deg, #e66a16, #d15a0c);
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(244, 123, 32, 0.3);
        }

        .btn-view-all {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            border: none;
            padding: 1rem 2rem;
            border-radius: 12px;
            font-weight: 700;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: block;
            margin: 2rem auto 0;
            max-width: 300px;
            text-align: center;
        }

        .btn-view-all:hover {
            background: linear-gradient(135deg, #2980b9, #21618c);
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(52, 152, 219, 0.3);
        }

        /* Loading และ Error States */
        .loading {
            text-align: center;
            padding: 3rem;
            color: #6c757d;
            font-size: 1.1rem;
        }

        .loading::after {
            content: '';
            display: inline-block;
            width: 24px;
            height: 24px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #f47b20;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-left: 1rem;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .error {
            text-align: center;
            padding: 2rem;
            background: #fff5f5;
            border: 2px solid #fed7d7;
            border-radius: 12px;
            margin: 2rem 0;
        }

        .error h3 {
            color: #e53e3e;
            margin-bottom: 1rem;
        }

        .error p {
            color: #718096;
            margin-bottom: 1rem;
        }

        .error-button {
            background: #f47b20;
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .error-button:hover {
            background: #e66a16;
            transform: translateY(-1px);
        }

        /* Mobile Optimizations */
        @media (max-width: 768px) {
            .container {
                padding: 0.75rem;
            }
            
            .car-image-container {
                height: 160px;
            }
            
            .car-content {
                padding: 1rem;
            }
            
            .car-title {
                font-size: 1rem;
                height: 2.6em;
            }
            
            .car-price {
                font-size: 1.2rem;
            }
            
            .section-title {
                font-size: 1.5rem;
            }
        }

        /* Ensure equal card heights */
        .cars-grid {
            align-items: stretch;
        }
        
        .car-card {
            min-height: 420px;
        }
        
        @media (max-width: 768px) {
            .car-card {
                min-height: 380px;
            }
        }
    </style>
</head>

<body>
    <!-- Header Section -->
    <header class="header">
        <div class="container">
            <h1>🚗 ครูหนึ่งรถสวย</h1>
            <p>รถมือสองคุณภาพเชียงใหม่ • รถเข้าใหม่ทุกวัน</p>
            <div class="header-features">
                <div class="header-feature">🆓 ฟรีดาวน์</div>
                <div class="header-feature">🛡️ รับประกัน 1 ปี</div>
                <div class="header-feature">🚚 ส่งฟรีทั่วไทย</div>
                <div class="header-feature">💰 ผ่อนถูก</div>
            </div>
        </div>
    </header>

    <div class="container">
        <!-- Cars Section -->
        <section class="cars-section">
            <h2 class="section-title">🔥 รถเข้าใหม่ 6 คันล่าสุด</h2>
            <div id="cars-grid" class="cars-grid">
                <div class="loading">⏳ กำลังโหลดข้อมูลรถ...</div>
            </div>
            
            <!-- View All Button -->
            <a href="https://chiangraiusedcar.com/all-cars-1" class="btn-view-all" target="_blank">
                🔍 ดูรถทั้งหมด
            </a>
        </section>
    </div>

    <!-- Service Worker Registration -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then(reg => console.log('SW registered'))
                    .catch(err => console.log('SW registration failed'));
            });
        }
    </script>

    <script>
        // Main cars loading function
        function loadCars() {
            fetch("cars.json")
                .then(response => {
                    if (!response.ok) {
                        throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                    }
                    return response.json();
                })
                .then(cars => {
                    console.log('Cars loaded:', cars.length);
                    
                    // Take only first 6 cars
                    const displayCars = cars.slice(0, 6);
                    
                    const carListHTML = displayCars.map((car, index) => {
                        // Get first image from images array
                        const carImage = car.images && car.images.length > 0 ? car.images[0] : 'https://dummyimage.com/400x300/eeeeee/cccccc&text=No+Image';
                        
                        // Format price
                        const formattedPrice = new Intl.NumberFormat('th-TH').format(car.price);
                        
                        // Truncate description for better display
                        const shortDesc = car.desc && car.desc.length > 80 ? car.desc.substring(0, 80) + '...' : car.desc || '';
                        
                        // Generate car detail link
                        const detailLink = `docs/car-detail/${car.handle}.html`;
                        
                        // Extract car features
                        const year = car.title.match(/\d{4}/)?.[0] || '';
                        const brand = car.title.split(' ')[0] || '';
                        
                        return `
                            <div class="car-card" itemscope itemtype="https://schema.org/Product">
                                <div class="car-image-container">
                                    <img src="${carImage}" 
                                         alt="${car.title} รถมือสองเชียงใหม่ ฟรีดาวน์" 
                                         class="car-image"
                                         loading="lazy" 
                                         decoding="async" 
                                         width="400" 
                                         height="200"
                                         itemprop="image"
                                         onerror="this.onerror=null;this.src='https://dummyimage.com/400x300/f8f9fa/adb5bd&text=รูปภาพไม่พร้อมใช้งาน';">
                                </div>
                                <div class="car-content">
                                    <h3 class="car-title" itemprop="name">${car.title}</h3>
                                    <div class="car-price" itemprop="offers" itemscope itemtype="https://schema.org/Offer">
                                        <span itemprop="price">฿${formattedPrice}</span>
                                        <meta itemprop="priceCurrency" content="THB">
                                        <meta itemprop="availability" content="https://schema.org/InStock">
                                    </div>
                                    <div class="car-details">
                                        <div class="car-status">พร้อมส่งมอบ</div>
                                        <div class="car-features">
                                            ${brand ? `<span class="car-feature">🚗 ${brand}</span>` : ''}
                                            ${year ? `<span class="car-feature">📅 ${year}</span>` : ''}
                                            <span class="car-feature">📍 เชียงใหม่</span>
                                        </div>
                                        <div class="car-description">${shortDesc}</div>
                                    </div>
                                    <a href="${detailLink}" class="btn-detail">
                                        ดูรายละเอียด
                                    </a>
                                </div>
                                <meta itemprop="brand" content="${brand}">
                                <meta itemprop="description" content="${car.desc || shortDesc}">
                            </div>
                        `;
                    }).join('');
                    
                    document.getElementById('cars-grid').innerHTML = carListHTML;
                    
                    // Update ItemList Schema with actual car data
                    updateItemListSchema(displayCars);
                    
                    // Log success
                    console.log('Cars displayed successfully');
                })
                .catch(error => {
                    console.error('Error loading cars:', error);
                    document.getElementById('cars-grid').innerHTML = `
                        <div class="error">
                            <h3>⚠️ ไม่สามารถโหลดข้อมูลรถได้</h3>
                            <p>กรุณาลองใหม่อีกครั้ง หรือติดต่อ 094-064-9019</p>
                            <button onclick="loadCars()" class="error-button">ลองใหม่</button>
                        </div>
                    `;
                });
        }

        // Update ItemList Schema with real car data
        function updateItemListSchema(cars) {
            const itemListElement = cars.map((car, index) => ({
                "@type": "Product",
                "position": index + 1,
                "name": car.title,
                "description": car.desc || `${car.title} รถมือสองเชียงใหม่ คุณภาพดี`,
                "image": car.images && car.images[0] ? car.images[0] : "",
                "brand": {
                    "@type": "Brand",
                    "name": car.title.split(' ')[0] || "รถมือสอง"
                },
                "offers": {
                    "@type": "Offer",
                    "price": car.price.toString(),
                    "priceCurrency": "THB",
                    "availability": "https://schema.org/InStock",
                    "url": `https://nblues.github.io/recommended-car/docs/car-detail/${car.handle}.html`
                },
                "aggregateRating": {
                    "@type": "AggregateRating",
                    "ratingValue": "4.8",
                    "reviewCount": "25"
                }
            }));

            // Find and update the ItemList schema
            const scripts = document.querySelectorAll('script[type="application/ld+json"]');
            scripts.forEach(script => {
                try {
                    const data = JSON.parse(script.textContent);
                    if (data["@type"] === "ItemList") {
                        data.itemListElement = itemListElement;
                        script.textContent = JSON.stringify(data, null, 2);
                    }
                } catch (e) {
                    console.warn('Could not update schema:', e);
                }
            });
        }

        // Load cars when page loads
        document.addEventListener('DOMContentLoaded', loadCars);
        
        // Fallback loading after delay
        setTimeout(loadCars, 1000);

        // Enhanced image error handling
        document.addEventListener('DOMContentLoaded', function() {
            document.addEventListener('error', function(e) {
                if (e.target.tagName === 'IMG') {
                    e.target.style.background = '#f8f9fa';
                    e.target.style.display = 'flex';
                    e.target.style.alignItems = 'center';
                    e.target.style.justifyContent = 'center';
                    e.target.alt = 'รูปภาพไม่พร้อมใช้งาน';
                }
            }, true);
        });

        // Performance monitoring
        if ('PerformanceObserver' in window) {
            try {
                const perfObserver = new PerformanceObserver((list) => {
                    for (const entry of list.getEntries()) {
                        if (entry.entryType === 'largest-contentful-paint') {
                            console.log('LCP:', Math.round(entry.startTime), 'ms');
                        }
                        if (entry.entryType === 'first-input') {
                            console.log('FID:', Math.round(entry.processingStart - entry.startTime), 'ms');
                        }
                    }
                });
                
                perfObserver.observe({entryTypes: ['largest-contentful-paint', 'first-input']});
            } catch (e) {
                console.warn('Performance observer not supported');
            }
        }
    </script>
</body>
</html>
